import{_ as i,g as c,u as d,f as m,e as p,h as f,c as h,q as _,s as k,o as b,t as g,x as w,a as v}from"./index-BLbGlZhr.js";const y=s=>(g("data-v-8959f065"),s=s(),w(),s),q={class:"preloader-overlay"},x=y(()=>v("span",{class:"flex justify-center animate-[spin_2s_linear_infinite] border-8 border-[#f1f2f3] border-l-biru border-r-biru rounded-full w-14 h-14 m-auto"},null,-1)),I=[x],R={__name:"CallbackGoogle",setup(s){const a=c(),o=d(),r=m(),n=p({id:null,email:"",role:"",token:""}),u=async()=>{try{const e=await _("post","auth/google/login",n.value,null);if(!e.data||!e.data.user)throw new Error("User data not found in response");const t=e.data.user.role;let l=e.data.customer||e.data.consultant||e.data;switch(localStorage.setItem("userData",JSON.stringify(l)),k.set("token",e.data.token,{expires:1}),r.commit("user",l),r.commit("userRole",t),r.commit("userEmail",e.data.user.email),t){case"customer":a.push({name:"views.dashboard"});break;case"consultant":a.push({name:"consultant.views.dashboard"});break;case"admin":a.push({name:"admin.views.dashboard"});break;case"staff":a.push({name:"staff.views.dashboard"});break;default:console.error("Role tidak dikenal:",t),a.push({name:"views.login"});break}}catch(e){console.error("Gagal mengambil data user:",e),a.push({name:"views.login"})}};return f(()=>{if(console.log("Full URL:",window.location.href),console.log("Route Query:",o.query),n.value={id:o.query.id||null,email:o.query.email||"",role:o.query.role||"",token:o.query.token||""},!n.value.token){console.error("Token tidak ditemukan!"),a.push({name:"views.login"});return}u()}),(e,t)=>(b(),h("div",q,I))}},B=i(R,[["__scopeId","data-v-8959f065"]]);export{B as default};
